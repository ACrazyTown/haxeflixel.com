<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML+RDFa 1.0//EN"
  "http://www.w3.org/MarkUp/DTD/xhtml-rdfa-1.dtd">

<!--
 __  __     ______     __  __     ______     ______   __         __     __  __     ______     __
/\ \_\ \   /\  __ \   /\_\_\_\   /\  ___\   /\  ___\ /\ \       /\ \   /\_\_\_\   /\  ___\   /\ \
\ \  __ \  \ \  __ \  \/_/\_\/_  \ \  __\   \ \  __\ \ \ \____  \ \ \  \/_/\_\/_  \ \  __\   \ \ \____
 \ \_\ \_\  \ \_\ \_\   /\_\/\_\  \ \_____\  \ \_\    \ \_____\  \ \_\   /\_\/\_\  \ \_____\  \ \_____\
  \/_/\/_/   \/_/\/_/   \/_/\/_/   \/_____/   \/_/     \/_____/   \/_/   \/_/\/_/   \/_____/   \/_____/

0.2.1 bootstrap
-->

<html class="cssgradients" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" version="XHTML+RDFa 1.0" dir="ltr">


<!-- Mirrored from 10.211.55.13/general-discussion/dynamic-lightning-shadows by HTTrack Website Copier/3.x [XR&CO'2013], Mon, 16 Dec 2013 10:13:39 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head profile="http://www.w3.org/1999/xhtml/vocab">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="shortcut icon" href="../sites/default/files/favicon_0.ico" type="image/vnd.microsoft.icon" />
<link rel="canonical" href="dynamic-lightning-shadows.html" />
<meta name="Generator" content="Drupal 7 (http://drupal.org)" />
<link rel="shortlink" href="http://10.211.55.13/node/562" />
    <title>Dynamic lightning &amp; shadows | HaxeFlixel</title>
    <link type="text/css" rel="stylesheet" href="../sites/default/files/css/css_791YXBaKKm1ORM_7huSKEsIV9tSWq6wmRkERhuXpN6w.css" media="all" />
<link type="text/css" rel="stylesheet" href="../sites/default/files/css/css_zHujuv7dvyvVeC2yIxRC-mNyBvEKEOO0ScWypJ-I-Mw.css" media="all" />
<link type="text/css" rel="stylesheet" href="http://10.211.55.13/sites/default/files/css/css_9rLhsDfWBDg6Xxfquvx2pTl-5xS8V2aWAGAgJJiO1LA.css" media="all" />
<style type="text/css" media="all">
<!--/*--><![CDATA[/*><!--*/
.panels-flexible-new .panels-flexible-region {
  padding: 0;
}

.panels-flexible-new .panels-flexible-region-inside {
  padding-right: 0.5em;
  padding-left: 0.5em;
}

.panels-flexible-new .panels-flexible-region-inside-first {
  padding-left: 0;
}

.panels-flexible-new .panels-flexible-region-inside-last {
  padding-right: 0;
}

.panels-flexible-new .panels-flexible-column {
  padding: 0;
}

.panels-flexible-new .panels-flexible-column-inside {
  padding-right: 0.5em;
  padding-left: 0.5em;
}

.panels-flexible-new .panels-flexible-column-inside-first {
  padding-left: 0;
}

.panels-flexible-new .panels-flexible-column-inside-last {
  padding-right: 0;
}

.panels-flexible-new .panels-flexible-row {
  padding: 0 0 0.5em 0;
  margin: 0;
}

.panels-flexible-new .panels-flexible-row-last {
  padding-bottom: 0;
}

.panels-flexible-column-new-main {
  float: left;
  width: 99.0000%;
}

.panels-flexible-new-inside {
  padding-right: 0px;
}

.panels-flexible-new {
  width: auto;
}

.panels-flexible-region-new-center {
  float: left;
  width: 99.0000%;
}

.panels-flexible-row-new-main-row-inside {
  padding-right: 0px;
}


/*]]>*/-->
</style>
<link type="text/css" rel="stylesheet" href="../sites/default/files/css/css_Lsj1hnFgUgcY_hv5ipXfmm5GWxFLNZGdCJOsxxBFxv0.css" media="all" />
<link type="text/css" rel="stylesheet" href="../sites/default/files/css/css_47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU.css" media="print" />
    <style type="text/css">
        body{
            margin-top: 120px;
        }

        #archive-warning {
            background: none repeat scroll 0 0 #000000;
            color: #FFFFFF;
            display: block;
            position: absolute;
            text-align: center;
            top: 0;
            width: 100%;
        }
        #archive-warning h2 {
            color: red;
        }
    </style>

    <script type="text/javascript" src="../sites/default/files/js/js_0gj6QcpfRH2jzTbCQqf7kEkm4MXY0UA_sRhwPc8jC1o.js"></script>
<script type="text/javascript" src="http://10.211.55.13/sites/default/files/js/js_KgCNQm_jdlbuilvxNQyCuzPIxbaHFd56Yhs0Gn31sJo.js"></script>
<script type="text/javascript" src="../sites/default/files/js/js_03PhocEaUymZGTRCa-nb226qVvl6eCiXz1vDVlRSXaw.js"></script>
<script type="text/javascript" src="../sites/default/files/js/js_DuCBxVBnmwlqi-FUiwD_uvjmLVBk6uphM_23_gbOteI.js"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.absolute_messages, {"dismiss":{"status":false,"warning":false,"error":false},"dismiss_time":{"status":"","warning":"","error":""},"dismiss_all_count":2});
//--><!]]>
</script>
<script type="text/javascript" src="http://10.211.55.13/sites/default/files/js/js_ZF6SOT9PTq0iEPo7-RfzYnr1x_D1rzKhlMMRiuLfQXE.js"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
var _gaq = _gaq || [];_gaq.push(["_setAccount", "UA-35511281-1"]);_gaq.push(["_trackPageview"]);(function() {var ga = document.createElement("script");ga.type = "text/javascript";ga.async = true;ga.src = ("https:" == document.location.protocol ? "https://ssl" : "http://www") + ".google-analytics.com/ga.js";var s = document.getElementsByTagName("script")[0];s.parentNode.insertBefore(ga, s);})();
//--><!]]>
</script>
<script type="text/javascript" src="../sites/default/files/js/js_uPcOSUjKf0Oc3qqo5JwAHcqGd498cAMC3xR3Hs-oqV8.js"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, {"basePath":"\/","pathPrefix":"","ajaxPageState":{"theme":"haxeflixel_bootstrap","theme_token":"Rp8n71glzChObIxaqHdng6V-ZhvdyDrgRYXpvGuJenI","js":{"sites\/all\/modules\/contrib\/syntaxhighlighter\/syntaxhighlighter.min.js":1,"sites\/all\/modules\/contrib\/jquery_update\/replace\/jquery\/1.7\/jquery.min.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1,"sites\/all\/modules\/contrib\/jquery_update\/replace\/ui\/external\/jquery.cookie.js":1,"sites\/all\/modules\/contrib\/jquery_update\/replace\/misc\/jquery.form.min.js":1,"misc\/ajax.js":1,"sites\/all\/libraries\/syntaxhighlighter\/scripts\/shCore.js":1,"sites\/all\/libraries\/syntaxhighlighter\/scripts\/shBrushAS3.js":1,"sites\/all\/libraries\/syntaxhighlighter\/scripts\/shBrushBash.js":1,"sites\/all\/libraries\/syntaxhighlighter\/scripts\/shBrushCpp.js":1,"sites\/all\/libraries\/syntaxhighlighter\/scripts\/shBrushHaxe.js":1,"sites\/all\/libraries\/syntaxhighlighter\/scripts\/shBrushJScript.js":1,"sites\/all\/libraries\/syntaxhighlighter\/scripts\/shBrushJava.js":1,"sites\/all\/libraries\/syntaxhighlighter\/scripts\/shBrushPhp.js":1,"sites\/all\/libraries\/syntaxhighlighter\/scripts\/shBrushPlain.js":1,"sites\/all\/libraries\/syntaxhighlighter\/scripts\/shBrushXml.js":1,"sites\/all\/modules\/contrib\/absolute_messages\/absolute_messages.js":1,"0":1,"sites\/all\/modules\/contrib\/panels\/js\/panels.js":1,"sites\/all\/modules\/contrib\/quote\/quote.js":1,"sites\/all\/modules\/contrib\/views\/js\/base.js":1,"misc\/progress.js":1,"sites\/all\/modules\/contrib\/views\/js\/ajax_view.js":1,"sites\/all\/modules\/contrib\/google_analytics\/googleanalytics.js":1,"1":1,"sites\/all\/themes\/radix\/assets\/javascripts\/modernizr-2.6.1.min.js":1,"sites\/all\/themes\/haxeflixel_bootstrap\/assets\/javascripts\/radix-script.js":1,"sites\/all\/themes\/haxeflixel_bootstrap\/assets\/javascripts\/bootstrap.js":1,"sites\/all\/themes\/haxeflixel_bootstrap\/assets\/javascripts\/script.js":1},"css":{"modules\/system\/system.base.css":1,"modules\/system\/system.messages.css":1,"modules\/system\/system.theme.css":1,"modules\/aggregator\/aggregator.css":1,"modules\/book\/book.css":1,"modules\/comment\/comment.css":1,"modules\/field\/theme\/field.css":1,"sites\/all\/modules\/haxeflixel_core\/layouts.css":1,"sites\/all\/modules\/contrib\/logintoboggan\/logintoboggan.css":1,"modules\/node\/node.css":1,"sites\/all\/modules\/contrib\/radix_layouts\/radix_layouts.css":1,"modules\/user\/user.css":1,"modules\/forum\/forum.css":1,"sites\/all\/modules\/contrib\/views\/css\/views.css":1,"sites\/all\/modules\/contrib\/absolute_messages\/absolute_messages.css":1,"sites\/all\/modules\/contrib\/ckeditor\/ckeditor.css":1,"sites\/all\/modules\/contrib\/ctools\/css\/ctools.css":1,"sites\/all\/modules\/contrib\/panels\/css\/panels.css":1,"sites\/all\/modules\/contrib\/quote\/quote.css":1,"sites\/all\/libraries\/syntaxhighlighter\/styles\/shCore.css":1,"sites\/all\/libraries\/syntaxhighlighter\/styles\/shThemeRDark.css":1,"sites\/all\/themes\/haxeflixel_bootstrap\/forum\/haxeflixel\/advanced-forum.haxeflixel.structure.css":1,"sites\/all\/themes\/haxeflixel_bootstrap\/forum\/haxeflixel\/advanced-forum.haxeflixel.style.css":1,"sites\/all\/themes\/haxeflixel_bootstrap\/forum\/haxeflixel\/advanced-forum.haxeflixel.images.css":1,"sites\/all\/modules\/contrib\/panels\/plugins\/layouts\/flexible\/flexible.css":1,"0":1,"sites\/all\/themes\/radix\/assets\/stylesheets\/radix-style.css":1,"sites\/all\/themes\/haxeflixel_bootstrap\/assets\/stylesheets\/screen.css":1,"sites\/all\/themes\/radix\/assets\/stylesheets\/radix-print.css":1,"sites\/all\/themes\/haxeflixel_bootstrap\/assets\/stylesheets\/print.css":1}},"quote_nest":"2","views":{"ajax_path":"\/views\/ajax","ajaxViews":{"views_dom_id:8e3932146f533eded74954c3caccfbfb":{"view_name":"similar_content","view_display_id":"default","view_args":"Dynamic\/lightning\/\u0026amp;\/shadows","view_path":"node\/562","view_base_path":null,"view_dom_id":"8e3932146f533eded74954c3caccfbfb","pager_element":"0"}}},"googleanalytics":{"trackOutbound":1,"trackMailto":1,"trackDownload":1,"trackDownloadExtensions":"7z|aac|arc|arj|asf|asx|avi|bin|csv|doc|exe|flv|gif|gz|gzip|hqx|jar|jpe?g|js|mp(2|3|4|e?g)|mov(ie)?|msi|msp|pdf|phps|png|ppt|qtm?|ra(m|r)?|sea|sit|tar|tgz|torrent|txt|wav|wma|wmv|wpd|xls|xml|z|zip"}});
//--><!]]>
</script>
    <!--[if lt IE 9]>
    <script>
    document.createElement('header');
    document.createElement('nav');
    document.createElement('section');
    document.createElement('article');
    document.createElement('aside');
    document.createElement('footer');
    </script>
    <![endif]-->
</head>
<body class="main-body">
  <div id="skip-link">
    <a href="#main-content" class="element-invisible element-focusable">Skip to main content</a>
  </div>
    
<div id="archive-warning">

    <h3>We have moved to a <a href="http://www.haxeflixel.com/forum">new forum</a> :)</h3>

    <p>You are viewing a read-only archive of the old forum. You can continue to post topics in the new <a href="http://www.haxeflixel.com/forum">forum here.</a></p>

</div>

<header id="header" class="header" role="header">
    <div class="container">

        <div class = "home-logo-button">
            <a href = "../index.html">
                <img src = "../sites/all/themes/haxeflixel_bootstrap/assets/images/haxeflixel-logo.png" alt = "HaxeFlixel"/>
            </a>
        </div>

        <div id="navigation" class="navbar">
            <div class="navbar-inner">
                <div class="container clearfix">

                    <a class="btn btn-navbar btn-navbar-menu" data-toggle="collapse" data-target=".nav-menu-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>

                    <a class="btn btn-navbar btn-navbar-search" data-toggle="collapse" data-target=".nav-search-collapse">
                        <span class="icon-search"></span>
                    </a>

                    <div class="nav-collapse nav-menu-collapse">
                        <div class="inner">
                            <ul id="main-menu-user" class="menu nav">
                <li class="first expanded dropdown open">
                    <a title="" href="http://forum.haxeflixel.com/user/">
                        <span>Login / Signup</span></span>
                    </a>
                </li>

            <li class="first">
                <a class="" title="" href="http://haxeflixel.com/demos/">
                    Demos
                </a>
            </li>

            <li class="first">
                <a class="" title="" href="http://haxeflixel.com/documentation">
                    Documentation
                </a>
            </li>

            <li class="first">
                <a class="" title="" href="http://forum.haxeflixel.com/">
                    Forum
                </a>
            </li>

            </ul>                        </div>
                    </div>

                    <div class="nav-collapse nav-search-collapse">
                        <div class="inner">
                                                    </div>
                    </div>

                </div>
            </div>
        </div>

        </div>

</header>
<div id="main-wrapper" class="container">
    <div id="main" class="main-container-style">
                    <div id="breadcrumb" class="">
                <div class="">
                    <h2 class="element-invisible">You are here</h2><div class="breadcrumb"><a href="../forum.html"><span>Forums</span></a> » <a href="../general-discussion.html"><span>General discussion</span></a></div>                </div>
            </div>
                        <div id="content">
            <a id="main-content"></a>
            <div id="page-header">
                <div class="">
                                                        </div>
            </div>
<div class="container">
    <div class="forum-container">
      <div class="panel-pane pane-node-title" >
  
      
  
  <div class="pane-content">
    <h1>Dynamic lightning &amp; shadows</h1>
  </div>

  
  </div>
<div class="panel-separator"></div><div class="panel-pane pane-forum-body-view" >
  
      
  
  <div class="pane-content">
    <a href="http://10.211.55.13/user/303"><span><img class="forum-created-avatar-img" src="../sites/default/files/styles/40px/public/avatar_selection/alien-010901.jpg?itok=SrUcAfD_" width="40" height="40" alt="" />xraven13</a>, <i class="icon-time"></i>  4 months 3 weeks ago</span><div class="btn-group forum-top-buttons"></div><hr><div class="field field-name-body field-type-text-with-summary field-label-hidden"><div class="field-items"><div class="field-item even"><p>Hey !</p>

<p>So we are making top-down game with realistic art style, and I was thinking how it would be great if we had something like this. &nbsp;Even if it's faked.</p>

<p>Game is 2D&nbsp;top-down, and here is a screenshot of super early build :</p>

<p><a href="https://dl.dropboxusercontent.com/u/63196046/gh_sc1.jpg">https://dl.dropboxusercontent.com/u/63196046/gh_sc1.jpg</a></p>

<p>Does anyone have suggestion how I could do this ? Is there anything in plan concerning this ? &nbsp; It would be great if we also have multiple number of light sources, but then that means I need to draw the shadow for each light source, and also delete some shadows depending on the light source, right ? Is this complex to make, and how much is hard on CPU and GPU ?</p>

<p>Thanks in advance.&nbsp;</p>
</div></div></div><br><div id="forum-comments" class="comment-wrapper">
  <a id="comment-2746"></a>
<div class="forum-post clearfix en posted-by-213 clearfix">
    <div class="media">

            <div class="author-panel-comment">
                <div class="author-pane-comment"><a href="http://10.211.55.13/users/solewalker" title="View user profile." class="username"><span>solewalker</span></a><a href="http://10.211.55.13/user/0"><img src="http://10.211.55.13/sites/default/files/styles/comment_avatar/public/avatars/niko_1.jpg?itok=63DIFRI5" width="90" height="90" alt="" /></a></div>                <div class="comment-sidebar"></div>            </div>

            <div class="comment-container">

                <div class="comment-header">

                    <div class="comment-submitted">
                        <a href="http://10.211.55.13/comment/2746#comment-2746" class="permalink pull-right" rel="bookmark"><span><i title="Comment Permalink" class="comment-inline-icon icon-comment"></i></span></a>                        4 months 3 weeks ago
                    </div>
                </div>

                <div class="content">

                    
                    <div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>Not sure about your effect, but anykind of modern lighteffect whats we see in many 2D games is possible with shaders, for that openfl needs to support Opengl es 2.0 or opengl 3.1, sadly its not supported at the moment. I am still waiting for openfl to support full fledged shader, this will not only boost performance for mobiles but also desktop imo.</p>
</div></div></div>
                    
                
                
                </div>


            </div>



        </div>
</div><a id="comment-2766"></a>
<div class="forum-post clearfix en posted-by-290 clearfix">
    <div class="media">

            <div class="author-panel-comment">
                <div class="author-pane-comment"><a href="http://10.211.55.13/users/xhunterko" title="View user profile." class="username"><span>xhunterko</span></a><a href="http://10.211.55.13/user/0"><img src="http://10.211.55.13/sites/default/files/styles/comment_avatar/public/avatars/tributeAvatar_1.png?itok=6L0wXiXO" width="90" height="90" alt="" /></a></div>                <div class="comment-sidebar"></div>            </div>

            <div class="comment-container">

                <div class="comment-header">

                    <div class="comment-submitted">
                        <a href="http://10.211.55.13/comment/2766#comment-2766" class="permalink pull-right" rel="bookmark"><span><i title="Comment Permalink" class="comment-inline-icon icon-comment"></i></span></a>                        4 months 2 weeks ago
                    </div>
                </div>

                <div class="content">

                    
                    <div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>This is done in as3 but it sounds something of what your looking for:</p>

<p><a href="http://blog.pixelpracht.net/?p=340">http://blog.pixelpracht.net/?p=340</a></p>
</div></div></div>
                    
                
                
                </div>


            </div>



        </div>
</div><a id="comment-2768"></a>
<div class="forum-post clearfix en posted-by-117 clearfix">
    <div class="media">

            <div class="author-panel-comment">
                <div class="author-pane-comment"><a href="http://10.211.55.13/users/skrivener" title="View user profile." class="username"><span>Skrivener</span></a><a href="http://10.211.55.13/user/0"><img src="http://10.211.55.13/sites/default/files/styles/comment_avatar/public/avatars/picture-117-1375328617.png?itok=e18jL4HY" width="90" height="90" alt="" /></a></div>                <div class="comment-sidebar"></div>            </div>

            <div class="comment-container">

                <div class="comment-header">

                    <div class="comment-submitted">
                        <a href="http://10.211.55.13/comment/2768#comment-2768" class="permalink pull-right" rel="bookmark"><span><i title="Comment Permalink" class="comment-inline-icon icon-comment"></i></span></a>                        4 months 2 weeks ago
                    </div>
                </div>

                <div class="content">

                    
                    <div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>In the pure flixel incarnation I was experimenting with using a shadow tilemap to provide both fog of war and pseudo-lighting. I haven't brought that feature over to haxe yet, and I'm not sure I'll use the same approach exactly, but here's a screenshot of what it looked like in AS3:</p>

<p><img alt="" src="http://philustration.com/misc/old-tilemap-lighting.png" /></p>

<p>This used raycasting to determine line of sight and hide anything blocked by a "full" tile, and intersected that result with a general falloff based on distance.</p>

<p>Rune hunt has a more sophisticated per-pixel lighting system, which is probably what I'll go for when I get to that again, but it seems to hit performance pretty hard.&nbsp;<a href="http://forums.flixel.org/index.php?topic=577.0" style="font-size: 17px;">http://forums.flixel.org/index.php?topic=577.0</a></p>

<p>If you google shadowcast, possibly with algorithms, flash, or actionscript you should find quite a bit out there.</p>

<p>Yes it's true that this is not actual dynamic lighting per se, it's a hack alternative, but I think you can get some pretty good results for performance cost. It might also be possible with a blending mode or custom pixel processing to have a separate shadowmap and overexposemap and use the overexpose to brighten pixels up toward a theoretical white and simulate brighter sources, and use RGB either within the *maps or have separate ones per channel to do colored lighting. Just shooting the breeze here, not anything like some useful code :) &nbsp;Talking theoretically, best performance (outside of shaders, which I'll admit to being pretty ignorant about)&nbsp;might be if we could hook into HaxeFlixel after it composited everything and run per-pixel manipulations based on a previously-generated lightmap. I looked at this back in Flixel a couple years ago but it was beyond me. Might try again and post it up if I come up with a solution, wont happen overnight though :)</p>
</div></div></div>
                    
                        <hr>

                        <div class="user-signature clearfix">
                            <p>~ Skrivener ~</p>
                        </div>

                        <hr>

                    
                
                
                </div>


            </div>



        </div>
</div><a id="comment-2851"></a>
<div class="forum-post clearfix en posted-by-303 post-by-starter clearfix">
    <div class="media">

            <div class="author-panel-comment">
                <div class="author-pane-comment"><a href="http://10.211.55.13/users/xraven13" title="View user profile." class="username"><span>xraven13</span></a><a href="http://10.211.55.13/user/0"><img src="http://10.211.55.13/sites/default/files/styles/comment_avatar/public/avatar_selection/alien-01.jpg?itok=XDArlZW9" width="90" height="90" alt="" /></a></div>                <div class="comment-sidebar"></div>            </div>

            <div class="comment-container">

                <div class="comment-header">

                    <div class="comment-submitted">
                        <a href="http://10.211.55.13/comment/2851#comment-2851" class="permalink pull-right" rel="bookmark"><span><i title="Comment Permalink" class="comment-inline-icon icon-comment"></i></span></a>                        4 months 1 week ago
                    </div>
                </div>

                <div class="content">

                    
                    <div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><!--break-->
<p>What would be the best way to achieve something like this ?&nbsp;</p>

<p><a href="https://www.dropbox.com/s/nxio1bvfcmcpjnn/erase.JPG">https://www.dropbox.com/s/nxio1bvfcmcpjnn/erase.JPG</a></p>

<p>Note that area that is in light should change the color a little like it's light falling over it. Maybe this could be achieved with some kinda blending ?&nbsp;</p>

<p>And this would be even better :</p>

<p><a href="https://www.dropbox.com/s/0d4unt6gujae7v8/LightExample.JPG">https://www.dropbox.com/s/0d4unt6gujae7v8/LightExample.JPG</a></p>

<p>So this could be done with raycasting I guess like someone commented in post above.</p>
</div></div></div>
                    
                        <hr>

                        <div class="user-signature clearfix">
                            <p><a href="https://www.facebook.com/chrismacangelo">https://www.facebook.com/chrismacangelo</a></p>

<p><a href="https://twitter.com/kurismakku">https://twitter.com/kurismakku</a></p>
                        </div>

                        <hr>

                    
                
                
                </div>


            </div>



        </div>
</div><a id="comment-2859"></a>
<div class="forum-post clearfix en posted-by-117 clearfix">
    <div class="media">

            <div class="author-panel-comment">
                <div class="author-pane-comment"><a href="http://10.211.55.13/users/skrivener" title="View user profile." class="username"><span>Skrivener</span></a><a href="http://10.211.55.13/user/0"><img src="http://10.211.55.13/sites/default/files/styles/comment_avatar/public/avatars/picture-117-1375328617.png?itok=e18jL4HY" width="90" height="90" alt="" /></a></div>                <div class="comment-sidebar"></div>            </div>

            <div class="comment-container">

                <div class="comment-header">

                    <div class="comment-submitted">
                        <a href="http://10.211.55.13/comment/2859#comment-2859" class="permalink pull-right" rel="bookmark"><span><i title="Comment Permalink" class="comment-inline-icon icon-comment"></i></span></a>                        4 months 1 week ago
                    </div>
                </div>

                <div class="content">

                    
                    <div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>Ok, so the deal with lighting algorithms gets complex and there are many ways to go, and I'm nothing like an expert, but I'll say what I can although it's not going to be specific code, just thoughts:</p>

<p>The central circle is easy enough, and the simplest and probably best performance solution to do it with haxeflixel is to create a graphic in an image editor that's a semi-transparent black (or similar) with a circle cut out in the center and run a blur on it, then add this to a sprite that sits over the rest of the game. If you want it to follow the player, then you would do kind of the inverse of that to have a blurred circle and use it as a mask to conceal that part of a solid graphic. So all of this just uses straight alpha blending which haxeflixel can do quickly and has good support for.</p>

<p>"But that's just cheating!" I'll pretend I hear you say ;) &nbsp;Yeah, it is! Lighting calculations are extremely expensive, and without GPU support quickly get prohibitive, so until we have shader support included we will have to make do with the cheaper solutions in all likelihood (but I'll expand below).</p>

<p>Now this is pretty weak I'll admit, this won't account for walls or objects or anything, just a magical glow that sees through all obstacles and casts no shadows.&nbsp;So what can we do about that?</p>

<p>Again the are several ways to go. The quick and cheap way to account for walls would be to store "rooms" as coordinates and clip the light circle based on the room you're in. This would still be cheap and quick and gets better, but does not cast shadows nicely from edges/corners or objects or handle corridors or anything. How about that?</p>

<p>So we're getting into more tricky territory there. Let's consider how we might build a really expensive solution instead of a cheap one for a minute. The really expensive solution would raycast every pixel, so:</p>


start with every pixel marked as black (hidden)
for each light source
  for each pixel in light radius
    for each pixel on a line from light origin to target pixel
      if this pixel is blocked
        true - this raycast is done, go to next pixel in light radius
        false - 
          calc light intensity by source intensity and distance from source
          if original is black set to intensity else blend intensity with original
      end if
    end for
  end for
end for
do a similar raycast check for what the player can see
intersect the two results to get the final lightmap
apply the lightmap, blend in some way if you want full shadow to be partly visible

<p>Now add translucency and color channel checking, and/or apply the lightmap in a more complex method than just masking the original. Scary huh? but this would give you most of what you wanted, with the exception of the low wall allowing light to bleed over, which you would probably need to to do on a second lighting pass or through some custom exception. You would just have to build an accurate blocking map to start with.</p>

<p>But is this practical? With shaders, probably yes, but support is not currently in haxeflixel, so what other things might make this practical without resorting to the super-simple option, where can we meet in the middle. Here's some optimization ideas:</p>

<ol>
	<li>where possible use some form of lookup (array, pre-made bitmap, etc.) instead of a calculation. Depending on the object, method, and calculation, it's likely to be faster.</li>
	<li>optimize operations&nbsp;- look at nme.Memory for fast manipulation of ByteArrays. If you get to this level, do fast approximate calculations instead of more accurate ones when&nbsp;it won't cause artifacts.</li>
	<li>Lower resolution of game display, or use a lower res lightmap and scale to final resolution. Because of 2 dimensions performance scales down exponentially as resolution scales up</li>
	<li>Do less frequent lightmap updates - eg. only recalc actual lighting when a light is added/removed/changed, so then you only need to do player FOV. If the player casts a moving light, but nothing else does, prebake all the other lighting at level creation and just apply the player light and FOV.</li>
	<li>Look into vector options and optimized raycasting. This is probably the most impactful solution. There's just so much stuff out there. Probably you'll have to store a vector opacity object for each "thing", or calculate them on the fly, and that will help get you start and end points to raycast against. <a href="http://www.redblobgames.com/articles/visibility/">Check this out for a start</a> (in Haxe!).</li>
	<li>Add shader support to HaxeFlixel :) &nbsp;I'm currently trialing <a href="https://github.com/HaxeFlixel/flixel/pull/571">a non-shader implementation of blending modes directly at the camera buffer</a>&nbsp;which is what I envisioned I might want to apply final lightmaps using something other than alpha blending, but I really want it to scale to higher resolutions without a prohibitive performance drop, and I'm not sure that the remaining tweaks I can do will get the performance where it needs to be. If that fails I may well take another look at the budding haxe/openfl shader implementations and see if we can't get something from there into haxeflixel. That's way outside of my comfort zone, but it really needs to happen anyway.</li>
</ol>

<p>&nbsp;</p>
</div></div></div>
                    
                        <hr>

                        <div class="user-signature clearfix">
                            <p>~ Skrivener ~</p>
                        </div>

                        <hr>

                    
                
                
                </div>


            </div>



        </div>
</div>        </div>
<hr><div class="login-btn-area"><a href="http://10.211.55.13/user/login?destination=node/562#comment-form" class="btn btn-info">Login to comment</a></div>  </div>

  
  </div>
<div class="panel-separator"></div><div class="panel-pane pane-custom pane-1" >
  
      
  
  <div class="pane-content">
    <hr>  </div>

  
  </div>
<div class="panel-separator"></div><div class="panel-pane pane-similar-content-pane" >
  
        <h4 class="pane-title">Search results for Dynamic lightning &amp; shadows</h4>
    
  
  <div class="pane-content">
    <div class="view view-similar-content view-id-similar_content view-display-id-default view-dom-id-8e3932146f533eded74954c3caccfbfb">
        
  
  
      <div class="view-content row-fluid">
      <table class="table table-bordered views-table cols-2" >
                <thead>
        <tr>
                            <th class="views-field views-field-title" >
                    Title                </th>
                            <th class="views-field views-field-type" >
                    Type                </th>
                    </tr>
        </thead>
        <tbody>
            <tr class="odd views-row-first">
                            <td class="views-field views-field-title" >
                    <a href="../help/hidingblocking-flxbuttons-solved.html"><span>Hiding/Blocking FlxButtons? [solved]</span></a>                </td>
                            <td class="views-field views-field-type" >
                    Forum topic                </td>
                    </tr>
            <tr class="even">
                            <td class="views-field views-field-title" >
                    <a href="rotated-pixel-perfect-collision.html"><span>Rotated pixel perfect collision?</span></a>                </td>
                            <td class="views-field views-field-type" >
                    Forum topic                </td>
                    </tr>
            <tr class="odd">
                            <td class="views-field views-field-title" >
                    <a href="solved-using-flxtween-complete-functions.html"><span>[SOLVED] Using FlxTween Complete Functions?</span></a>                </td>
                            <td class="views-field views-field-type" >
                    Forum topic                </td>
                    </tr>
            <tr class="even views-row-last">
                            <td class="views-field views-field-title" >
                    <a href="solved-cross-platform-time-tracking.html"><span>[SOLVED] Cross-platform time tracking?</span></a>                </td>
                            <td class="views-field views-field-type" >
                    Forum topic                </td>
                    </tr>
        </tbody>
</table>     </div>
  
      <h2 class="element-invisible">Pages</h2><div class="item-list"><ul class="pager"><li class="pager-current first">1</li>
<li class="pager-item"><a title="Go to page 2" href="http://10.211.55.13/general-discussion/dynamic-lightning-shadows?page=1">2</a></li>
<li class="pager-item"><a title="Go to page 3" href="http://10.211.55.13/general-discussion/dynamic-lightning-shadows?page=2">3</a></li>
<li class="pager-ellipsis">…</li>
<li class="pager-next"><a href="http://10.211.55.13/general-discussion/dynamic-lightning-shadows?page=1">›</a></li>
<li class="pager-last last"><a href="http://10.211.55.13/general-discussion/dynamic-lightning-shadows?page=165">»</a></li>
</ul></div>  
  
  
  
  
</div>  </div>

  
  </div>
    </div>
</div>
</div>
</div>
</div>
<footer id="footer" class="footer-bg" role="footer">
    <div class="container">
        <div class="row-fluid">
            <div class="span6">
                <ul class="footer-menu">
                    <li><a href="http://www.haxe.org/"><img src="../sites/all/themes/haxeflixel_bootstrap/assets/images/haxe-logo.png" width="26px"/></a></li>
                    <li><a href="http://www.openfl.org/"><img src="../sites/all/themes/haxeflixel_bootstrap/assets/images/nme-logo.png" width="26px"/></a></li>
                    <li><a href="http://haxeflixel.com/documentation/">Documentation</a></li>
                    <li><a href="http://haxeflixel.com/demos/">Demos</a></li>
                </ul>
            </div>
            <div class="span6">
                <div class="footer-social-links">
                    <iframe width="110px" scrolling="0" height="26px" frameborder="0" allowtransparency="true"
                            src="http://ghbtns.com/github-btn.html?user=HaxeFlixel&amp;repo=flixel&amp;type=fork&amp;count=true&amp;"></iframe>

                    <iframe width="110px" scrolling="0" height="26px" frameborder="0" allowtransparency="true"
                            src="http://ghbtns.com/github-btn.html?user=HaxeFlixel&amp;repo=flixel&amp;type=watch&amp;count=true&amp;"></iframe>

                    <iframe allowtransparency="true" frameborder="0" scrolling="no"
                            src="http://platform.twitter.com/widgets/follow_button.html?screen_name=haxeflixel"
                            style="width:230px; height:26px;">
                    </iframe>
                </div>
            </div>
        </div>
</footer>  <script type="text/javascript" src="../sites/default/files/js/js_Rk5YIkK6m2gKTGH-GrMu0pM_PlMKXnI0ktQUgXw1XgA.js"></script>

<div class="bg_highlight"></div>

</body>


<!-- Mirrored from 10.211.55.13/general-discussion/dynamic-lightning-shadows by HTTrack Website Copier/3.x [XR&CO'2013], Mon, 16 Dec 2013 10:13:39 GMT -->
</html>